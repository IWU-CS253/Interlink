{% extends "layout.html" %}
{% block body %}
<div class="container mt-4" style="max-width: 500px;">

    <h1 class="mb-4 text-center">Create a League and Teams</h1>

    {% if error %}
        <div class="alert alert-danger">
            <strong>Error:</strong> {{ error }}
        </div>
    {% endif %}

    <!--
    "step" system let me make 2 forms on the same page by loading the first one, letting the user
    set up the league first and make a max team value and then in the second step, it uses the max team
    value previously set and then makes x amount of form slots for that many teams, which don't have to be
    filled out but can be if the league admin knows all the team info.
    -->
    {% if step == 1 or step is not defined %}
    <form action="{{ url_for('whole_league_creation') }}" method="post" class="card p-4 shadow-sm">
        <input type="hidden" name="step" value="1">
        <div class="form-group mb-3">
            <label for="league_name">League Name</label>
            <input class="form-control" id="league_name" type="text" name="league_name" required>
        </div>

        <div class="form-group mb-3">
            <select name="sport" required class="form-select" aria-label="Default select example">
                <option disabled selected>Select a sport</option>
                <option value="Soccer">Soccer</option>
                <option value="Football">Football</option>
                <option value="Basketball">Basketball</option>
                <option value="Volleyball">Volleyball</option>
                <option value="Water Polo">Water Polo</option>
                <option value="Badminton">Badminton</option>
            </select>
        </div>

        <div class="form-group mb-3">
            <label for="max_teams">Max Teams</label>
            <input class="form-control" id="max_teams" type="number" name="max_teams" required>
        </div>
        <button type="submit" class="btn btn-primary w-100">
            Next: Add Teams
        </button>
    </form>
    {% elif step == 2 %}
    <!--Step 2 add Teams-->
    <form action="{{ url_for('whole_league_creation') }}" method="post" class="card p-4 shadow-sm">
        <input type="hidden" name="step" value="2">
        <!--Bring league info with in hidden fields for later submission-->
        <input type="hidden" name="league_name" value="{{ league_name }}">
        <input type="hidden" name="sport" value="{{ sport }}">
        <input type="hidden" name="max_teams" value="{{ max_teams }}">
        <h5 class="mb-3">League: {{ league_name }} ({{ sport }})</h5>
        <p class="">You can create up to {{ max_teams }} teams. Leave any unused fields blank.</p>

        {% set names = team_names or [] %}
        {% for i in range(max_teams) %}
            <div class="form-group mb-2">
                <label for="team_input_{{ i }}">Team {{ i + 1 }}</label>
                <input id="team_input_{{ i }}" type="text" name="team_names[]" class="form-control" value="{% if i < names|length %}{{ names[i] }}{% endif %}" placeholder="Enter team name">
            </div>
        {% endfor %}
        <div>
            <label for="league_admin">League Admin</label>
            <input type="text"
                   id="league_admin"
               name="league_admin"
               class="form-control form-control-sm"
               placeholder="League Admin Username"
               required>
        </div>
        <button type="submit" class="btn btn-primary w-100 mt-3">
            Create League & Teams
        </button>
    </form>
    {% endif %}
</div>
{% endblock %}